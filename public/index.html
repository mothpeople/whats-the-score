<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>What's the Score?</title>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#fbf7ff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="description" content="Live scores from EPL, SPL, ACL, and more.">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Icons (Lucide) -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">

    <style>
        /* --- THEME CONFIGURATION --- */
        :root {
            /* Light Mode (Default - Pale Lilac) */
            --bg-body: #fbf7ff; /* Very pale lilac */
            --bg-card: #ffffff;
            --bg-glass: rgba(251, 247, 255, 0.95);
            --text-main: #1e1b4b; /* Dark Indigo */
            --text-muted: #6b7280;
            --accent-primary: #c4b5fd; /* Lilac (Violet-300) */
            --accent-glow: rgba(196, 181, 253, 0.6);
            --accent-text: #7c3aed; /* Deep Violet Text */
            --border-color: #ede9fe;
            --live-color: #8b5cf6; /* Violet for live in light mode */
            --nav-active: #7c3aed;
        }

        [data-theme="dark"] {
            /* Dark Mode (Red/Black) */
            --bg-body: #050505;
            --bg-card: #121212;
            --bg-glass: rgba(18, 18, 18, 0.9);
            --text-main: #f5f5f5;
            --text-muted: #a3a3a3;
            --accent-primary: #9f1239; /* Dark Red */
            --accent-glow: rgba(159, 18, 57, 0.4);
            --accent-text: #fda4af; /* Light Red Text */
            --border-color: #262626;
            --live-color: #ef4444; /* Red for live */
            --nav-active: #fda4af;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-body);
            color: var(--text-main);
            transition: background-color 0.3s ease, color 0.3s ease;
            -webkit-tap-highlight-color: transparent;
        }

        /* --- UTILITIES --- */
        .font-display { font-family: 'Space Grotesk', sans-serif; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        /* Custom Theme Classes */
        .theme-bg-card { background-color: var(--bg-card); transition: background-color 0.3s ease; }
        .theme-border { border-color: var(--border-color); transition: border-color 0.3s ease; }
        .theme-accent { background-color: var(--accent-primary); }
        .theme-text-accent { color: var(--accent-text); }
        
        .card-gradient {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
        }

        .glass {
            background: var(--bg-glass);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-top: 1px solid var(--border-color);
        }

        /* Animations */
        @keyframes pulse-live {
            0% { box-shadow: 0 0 0 0 var(--accent-glow); }
            70% { box-shadow: 0 0 0 6px rgba(0,0,0, 0); }
            100% { box-shadow: 0 0 0 0 rgba(0,0,0, 0); }
        }
        .live-indicator {
            background-color: var(--live-color);
            animation: pulse-live 2s infinite;
        }
        
        /* View Switching */
        .view-section {
            display: none;
            height: 100%;
            flex-direction: column;
        }
        .view-section.active {
            display: flex;
        }
        
        /* Modal Transitions */
        .modal-enter { transform: translateY(100%); }
        .modal-enter-active { transform: translateY(0); transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1); }
        .modal-exit-active { transform: translateY(100%); transition: transform 0.3s ease-in; }
    </style>
</head>
<body class="h-screen flex flex-col overflow-hidden" data-theme="light">

    <!-- Header -->
    <header class="flex-none px-5 py-4 flex items-center justify-between z-20 theme-bg-card border-b theme-border">
        <!-- Title (Clean) -->
        <h1 class="text-xl font-bold tracking-tight font-display">What's the Score?</h1>
        
        <div class="flex items-center space-x-3">
            <!-- Donate Button (Clean text) -->
            <a href="https://PayPal.me/sivarajpragasm" target="_blank" class="px-4 py-1.5 rounded-full bg-[#003087] text-white text-xs font-bold hover:bg-[#001c64] transition-colors shadow-sm">
                Donate
            </a>

            <!-- Theme Toggle -->
            <button onclick="toggleTheme()" class="p-2 rounded-full theme-border border bg-transparent text-[var(--text-muted)] hover:text-[var(--text-main)]">
                <i data-lucide="sun" id="themeIcon" class="w-5 h-5"></i>
            </button>
        </div>
    </header>

    <!-- VIEW: MATCHES -->
    <div id="view-matches" class="view-section active flex-1 overflow-hidden relative">
        <!-- Filters -->
        <div class="flex-none pb-2 z-10 space-y-3 pt-3">
            <!-- Date Scroller -->
            <div class="flex space-x-3 overflow-x-auto px-4 pb-2 no-scrollbar">
                <button class="flex-none px-4 py-2 rounded-full theme-bg-card border theme-border text-[var(--text-muted)] text-xs font-medium">Yesterday</button>
                <button class="flex-none px-4 py-2 rounded-full theme-accent text-white shadow-lg text-xs font-bold">Today</button>
                <button class="flex-none px-4 py-2 rounded-full theme-bg-card border theme-border text-[var(--text-muted)] text-xs font-medium">Tomorrow</button>
            </div>

            <!-- League Selector (COMPLETE LIST) -->
            <div class="px-4">
                <div class="relative group">
                    <select id="leagueSelect" class="w-full theme-bg-card text-[var(--text-main)] p-3 pl-10 rounded-xl border theme-border focus:outline-none appearance-none font-medium text-sm transition-all shadow-sm">
                        <option value="All">Live & Top Matches</option>
                        
                        <optgroup label="Europe">
                            <option value="Premier League">English Premier League</option>
                            <option value="La Liga">Spanish La Liga</option>
                            <option value="Serie A">Italian Serie A</option>
                            <option value="Ligue 1">French Ligue 1</option>
                        </optgroup>
                        
                        <optgroup label="Asia">
                            <option value="SPL (Singapore)">SPL (Singapore)</option>
                            <option value="J1 League">J-League 1</option>
                            <option value="K League 1">K-League 1</option>
                            <option value="V.League 1">V-League 1</option>
                        </optgroup>

                        <optgroup label="UEFA Competitions">
                            <option value="Champions League">UEFA Champions League</option>
                            <option value="Europa League">UEFA Europa League</option>
                            <option value="Conference League">UEFA Conference League</option>
                            <option value="UEFA EURO">UEFA EURO Championships</option>
                        </optgroup>

                        <optgroup label="AFC Competitions">
                            <option value="ACL Elite">AFC Champions League Elite</option>
                            <option value="ACL 2">AFC Champions League Two</option>
                            <option value="AFC Asian Cup">AFC Asian Cup</option>
                        </optgroup>

                        <optgroup label="International">
                            <option value="World Cup Qualifiers">World Cup Qualifiers</option>
                            <option value="Friendlies">International Friendlies</option>
                        </optgroup>
                    </select>
                    
                    <div class="absolute left-3 top-3.5 pointer-events-none theme-text-accent">
                        <i data-lucide="filter" class="w-4 h-4"></i>
                    </div>
                    <div class="absolute right-3 top-3.5 pointer-events-none text-[var(--text-muted)]">
                        <i data-lucide="chevron-down" class="w-4 h-4"></i>
                    </div>
                </div>
            </div>
        </div>

        <!-- Match List -->
        <div id="matchList" class="flex-1 overflow-y-auto p-4 space-y-3 pb-24 scroll-smooth">
            <!-- Injected via JS -->
        </div>
    </div>

    <!-- VIEW: FOLLOWING (History) -->
    <div id="view-following" class="view-section flex-1 overflow-hidden relative">
        <div class="p-6 flex-1 overflow-y-auto pb-24" id="followingContent">
            <!-- Injected via JS -->
        </div>
    </div>

    <!-- VIEW: NEWS -->
    <div id="view-news" class="view-section flex-1 overflow-hidden relative">
        <div class="p-4 flex-1 overflow-y-auto pb-24 space-y-4">
            <h2 class="text-lg font-display font-bold px-2">Latest Headlines</h2>
            
            <div class="card-gradient rounded-xl overflow-hidden shadow-sm">
                <div class="h-32 bg-gray-200 relative">
                     <img src="https://images.unsplash.com/photo-1522778119026-d647f0565c6a?auto=format&fit=crop&q=80&w=600" class="w-full h-full object-cover">
                     <div class="absolute bottom-0 left-0 bg-black/50 text-white text-[10px] px-2 py-1">SPL (Singapore)</div>
                </div>
                <div class="p-4">
                    <h3 class="font-bold text-sm mb-1 text-[var(--text-main)]">Lion City Sailors secure crucial 3 points</h3>
                    <p class="text-xs text-[var(--text-muted)] line-clamp-2">A dramatic late winner from Shawal Anuar keeps the title race alive as the Sailors edge past Tampines in a thriller.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <nav class="flex-none glass fixed bottom-0 w-full pb-safe pt-2 z-30">
        <div class="flex justify-around items-center pb-4">
            <button onclick="switchTab('matches')" id="nav-matches" class="nav-item active flex flex-col items-center space-y-1 transition-all" style="color: var(--nav-active)">
                <i data-lucide="trophy" class="w-5 h-5"></i>
                <span class="text-[10px] font-semibold">Matches</span>
            </button>
            <button onclick="switchTab('following')" id="nav-following" class="nav-item flex flex-col items-center space-y-1 text-[var(--text-muted)] hover:text-[var(--text-main)] transition-all">
                <i data-lucide="star" class="w-5 h-5"></i>
                <span class="text-[10px] font-medium">Following</span>
            </button>
            <button onclick="switchTab('news')" id="nav-news" class="nav-item flex flex-col items-center space-y-1 text-[var(--text-muted)] hover:text-[var(--text-main)] transition-all">
                <i data-lucide="newspaper" class="w-5 h-5"></i>
                <span class="text-[10px] font-medium">News</span>
            </button>
        </div>
    </nav>

    <!-- Match Details Modal -->
    <div id="matchModal" class="fixed inset-0 z-50 hidden">
        <div class="absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity opacity-0" id="modalBackdrop" onclick="closeModal()"></div>
        
        <div class="absolute bottom-0 left-0 right-0 theme-bg-card rounded-t-[2rem] h-[92vh] flex flex-col modal-enter-active shadow-2xl border-t theme-border" id="modalPanel">
            
            <!-- Handle -->
            <div class="flex justify-center pt-4 pb-2" onclick="closeModal()">
                <div class="w-12 h-1.5 bg-gray-500 rounded-full cursor-pointer opacity-30"></div>
            </div>

            <!-- Header -->
            <div class="flex-none px-6 pb-6 pt-2 border-b theme-border relative">
                <div class="flex justify-between items-start mb-6">
                    <span class="text-xs font-bold tracking-widest theme-text-accent uppercase px-2 py-1 border theme-border rounded" id="modalLeague">League</span>
                    <button onclick="closeModal()" class="text-[var(--text-muted)] hover:text-[var(--text-main)]"><i data-lucide="x" class="w-6 h-6"></i></button>
                </div>
                
                <div class="flex justify-between items-center">
                    <div class="flex flex-col items-center w-1/3 space-y-2">
                        <div class="w-16 h-16 rounded-full theme-bg-card flex items-center justify-center shadow-sm border theme-border">
                            <span class="text-3xl" id="modalHomeLogo">üè†</span>
                        </div>
                        <span class="text-sm font-bold text-center leading-tight" id="modalHomeName">Home</span>
                    </div>
                    
                    <div class="flex flex-col items-center w-1/3">
                        <div class="text-4xl font-display font-bold tracking-tighter" id="modalScore">0-0</div>
                        <div id="modalStatus" class="mt-2 px-3 py-1 text-xs font-bold rounded-full border theme-border">--</div>
                    </div>

                    <div class="flex flex-col items-center w-1/3 space-y-2">
                        <div class="w-16 h-16 rounded-full theme-bg-card flex items-center justify-center shadow-sm border theme-border">
                            <span class="text-3xl" id="modalAwayLogo">‚úàÔ∏è</span>
                        </div>
                        <span class="text-sm font-bold text-center leading-tight" id="modalAwayName">Away</span>
                    </div>
                </div>
            </div>

            <!-- Content -->
            <div class="flex-1 overflow-y-auto p-6 space-y-8">
                <!-- Events -->
                <div>
                    <h3 class="text-xs font-bold text-[var(--text-muted)] uppercase tracking-widest mb-4">Timeline</h3>
                    <div id="eventsList" class="space-y-0 relative pl-4 border-l theme-border ml-4">
                        <!-- Events injected here -->
                    </div>
                </div>
                <!-- Stats Preview -->
                <div class="theme-bg-card rounded-2xl p-4 border theme-border shadow-sm">
                    <h3 class="text-xs font-bold text-[var(--text-muted)] uppercase tracking-widest mb-4">Quick Stats</h3>
                    <div id="statsList" class="space-y-4"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- THEME LOGIC ---
        let isDark = false; 
        
        function toggleTheme() {
            isDark = !isDark;
            const body = document.body;
            const icon = document.getElementById('themeIcon');
            const metaThemeColor = document.querySelector('meta[name="theme-color"]');
            
            if (isDark) {
                body.setAttribute('data-theme', 'dark');
                icon.setAttribute('data-lucide', 'moon');
                metaThemeColor.setAttribute('content', '#050505'); 
            } else {
                body.setAttribute('data-theme', 'light');
                icon.setAttribute('data-lucide', 'sun');
                metaThemeColor.setAttribute('content', '#fbf7ff');
            }
            lucide.createIcons();
        }

        // --- NAVIGATION LOGIC ---
        let currentTab = 'matches';

        function switchTab(tabName) {
            currentTab = tabName;
            document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active'));
            document.getElementById(`view-${tabName}`).classList.add('active');
            document.querySelectorAll('.nav-item').forEach(el => {
                el.style.color = 'var(--text-muted)';
                el.classList.remove('active');
            });
            const activeNav = document.getElementById(`nav-${tabName}`);
            activeNav.style.color = 'var(--nav-active)';
            activeNav.classList.add('active');

            if (tabName === 'following') {
                renderFollowing();
            }
        }

        // --- FAVORITES LOGIC ---
        let favoriteTeam = localStorage.getItem('favTeam');

        function setFavorite(teamName) {
            favoriteTeam = teamName;
            localStorage.setItem('favTeam', teamName);
            renderFollowing();
        }

        function clearFavorite() {
            favoriteTeam = null;
            localStorage.removeItem('favTeam');
            renderFollowing();
        }

        function renderFollowing() {
            const container = document.getElementById('followingContent');
            container.innerHTML = '';

            if (!favoriteTeam) {
                container.innerHTML = `
                    <div class="flex flex-col items-center justify-center h-full text-center space-y-6 pt-10">
                        <div class="w-16 h-16 rounded-full theme-bg-card border theme-border flex items-center justify-center shadow-sm">
                            <i data-lucide="star" class="w-8 h-8 text-[var(--accent-text)]"></i>
                        </div>
                        <div>
                            <h2 class="text-xl font-bold font-display text-[var(--text-main)]">Pick a Team</h2>
                            <p class="text-sm text-[var(--text-muted)] mt-2 px-6">Select a team to see their match history and upcoming fixtures.</p>
                        </div>
                        <div class="w-full max-w-xs space-y-3">
                            <button onclick="setFavorite('Lion City Sailors')" class="w-full p-4 theme-bg-card border theme-border rounded-xl flex items-center space-x-3 hover:border-[var(--accent-primary)] transition-all">
                                <span class="text-xl">ü¶Å</span>
                                <span class="font-bold text-[var(--text-main)]">Lion City Sailors</span>
                            </button>
                             <button onclick="setFavorite('Man City')" class="w-full p-4 theme-bg-card border theme-border rounded-xl flex items-center space-x-3 hover:border-[var(--accent-primary)] transition-all">
                                <span class="text-xl">üîµ</span>
                                <span class="font-bold text-[var(--text-main)]">Man City</span>
                            </button>
                        </div>
                    </div>
                `;
            } else {
                const teamMatches = mockMatches.filter(m => m.home === favoriteTeam || m.away === favoriteTeam);
                
                let headerHTML = `
                    <div class="flex items-center justify-between mb-6">
                        <div class="flex items-center space-x-3">
                            <h2 class="text-xl font-bold font-display text-[var(--text-main)]">${favoriteTeam}</h2>
                            <span class="text-xs px-2 py-1 theme-accent text-white rounded-full">Following</span>
                        </div>
                        <button onclick="clearFavorite()" class="text-xs text-[var(--text-muted)] underline">Change</button>
                    </div>
                `;

                if (teamMatches.length === 0) {
                    container.innerHTML = headerHTML + `<div class="text-center text-[var(--text-muted)] mt-10">No recent matches found for this team.</div>`;
                } else {
                    let listHTML = `<div class="space-y-3">`;
                    teamMatches.forEach(match => {
                        const isLive = match.status === 'LIVE';
                        listHTML += `
                            <div onclick="openModal(${match.id})" class="card-gradient rounded-xl p-4 shadow-sm border theme-border flex items-center justify-between cursor-pointer">
                                <div class="text-xs font-bold text-[var(--text-muted)] w-12">${match.status === 'FT' ? match.date || 'Today' : match.status}</div>
                                <div class="flex-1 flex flex-col items-center">
                                    <div class="flex items-center justify-center space-x-2 text-sm font-semibold text-[var(--text-main)]">
                                        <span>${match.home}</span>
                                        <span class="text-[var(--text-muted)]">vs</span>
                                        <span>${match.away}</span>
                                    </div>
                                    <div class="text-xs font-mono font-bold mt-1 ${isLive ? 'theme-text-accent' : ''}">${match.score}</div>
                                </div>
                            </div>
                        `;
                    });
                    listHTML += `</div>`;
                    container.innerHTML = headerHTML + listHTML;
                }
            }
            lucide.createIcons();
        }


        // --- COMPLETE MOCK DATA FOR ALL COMPETITIONS ---
        // Ensuring every single dropdown option has at least one result
        const mockMatches = [
            // Premier League
            { id: 101, league: "Premier League", date: "Today", home: "Man City", away: "Liverpool", homeLogo: "üîµ", awayLogo: "üî¥", score: "2 - 2", status: "LIVE", minute: "78'", events: [{ type: "goal", team: "home", player: "E. Haaland", time: "12'" }], stats: { possession: [58, 42], shots: [14, 10], xg: [2.1, 1.8] } },
            
            // SPL
            { id: 501, league: "SPL (Singapore)", date: "Today", home: "Lion City Sailors", away: "Tampines Rovers", homeLogo: "ü¶Å", awayLogo: "ü¶å", score: "3 - 2", status: "FT", minute: "FT", events: [{ type: "goal", team: "home", player: "Lestienne", time: "22'" }], stats: { possession: [52, 48], shots: [12, 14], xg: [2.5, 2.1] } },
            { id: 502, league: "SPL (Singapore)", date: "24 Nov", home: "Albirex Niigata (S)", away: "Lion City Sailors", homeLogo: "ü¶¢", awayLogo: "ü¶Å", score: "1 - 4", status: "FT", minute: "FT", events: [], stats: { possession: [40, 60], shots: [5, 12], xg: [0.5, 3.1] } },

            // V-League
            { id: 201, league: "V.League 1", date: "Today", home: "Cong An Ha Noi", away: "Hanoi FC", homeLogo: "üëÆ", awayLogo: "üü£", score: "1 - 0", status: "LIVE", minute: "32'", events: [{ type: "goal", team: "home", player: "Quang Hai", time: "15'" }], stats: { possession: [45, 55], shots: [4, 6], xg: [0.8, 0.4] } },
            
            // J-League
            { id: 801, league: "J1 League", date: "Today", home: "Vissel Kobe", away: "Gamba Osaka", homeLogo: "‚öì", awayLogo: "‚ö°", score: "2 - 0", status: "FT", minute: "FT", events: [], stats: { possession: [50, 50], shots: [8, 8], xg: [1.1, 0.9] } },
            
            // K-League
            { id: 802, league: "K League 1", date: "Today", home: "Ulsan HD", away: "Jeonbuk Motors", homeLogo: "üêØ", awayLogo: "üü¢", score: "1 - 1", status: "FT", minute: "FT", events: [], stats: { possession: [55, 45], shots: [10, 8], xg: [1.2, 1.1] } },

            // La Liga
            { id: 401, league: "La Liga", date: "Yesterday", home: "Real Madrid", away: "Barcelona", homeLogo: "üëë", awayLogo: "üíô", score: "1 - 3", status: "FT", minute: "FT", events: [{ type: "goal", team: "away", player: "Lewandowski", time: "10'" }], stats: { possession: [45, 55], shots: [9, 15], xg: [1.2, 3.1] } },
            
            // Serie A
            { id: 402, league: "Serie A", date: "Today", home: "Inter Milan", away: "Juventus", homeLogo: "‚ö´üîµ", awayLogo: "‚ö´‚ö™", score: "0 - 0", status: "LIVE", minute: "15'", events: [], stats: { possession: [50, 50], shots: [2, 1], xg: [0.1, 0.1] } },
            
            // Ligue 1
            { id: 403, league: "Ligue 1", date: "Today", home: "PSG", away: "Marseille", homeLogo: "üóº", awayLogo: "üîµ", score: "-", status: "20:00", minute: "", events: [], stats: { possession: [0, 0], shots: [0, 0], xg: [0, 0] } },

            // Champions League
            { id: 301, league: "Champions League", date: "Tue", home: "Man City", away: "Feyenoord", homeLogo: "üîµ", awayLogo: "üî¥", score: "3 - 3", status: "FT", minute: "FT", events: [], stats: { possession: [60, 40], shots: [20, 5], xg: [3.5, 0.8] } },

            // Europa League
            { id: 302, league: "Europa League", date: "Thu", home: "Man Utd", away: "Bodo/Glimt", homeLogo: "üî¥", awayLogo: "üü°", score: "3 - 2", status: "FT", minute: "FT", events: [], stats: { possession: [65, 35], shots: [18, 6], xg: [2.5, 0.9] } },
            
            // Conference League
            { id: 303, league: "Conference League", date: "Thu", home: "Chelsea", away: "Heidenheim", homeLogo: "üîµ", awayLogo: "üî¥", score: "2 - 0", status: "FT", minute: "FT", events: [], stats: { possession: [70, 30], shots: [12, 4], xg: [2.1, 0.3] } },

            // ACL Elite
            { id: 304, league: "ACL Elite", date: "Yesterday", home: "Yokohama F. M.", away: "Buriram Utd", homeLogo: "‚öì", awayLogo: "‚ö°", score: "3 - 1", status: "FT", minute: "FT", events: [], stats: { possession: [62, 38], shots: [18, 5], xg: [3.2, 0.4] } },

            // ACL 2
            { id: 305, league: "ACL 2", date: "Wed", home: "Lion City Sailors", away: "Persib Bandung", homeLogo: "ü¶Å", awayLogo: "üîµ", score: "2 - 3", status: "FT", minute: "FT", events: [], stats: { possession: [48, 52], shots: [10, 12], xg: [1.5, 1.8] } },

            // International / Euros / Asian Cup / WCQ
            { id: 601, league: "World Cup Qualifiers", date: "Last Week", home: "Indonesia", away: "Saudi Arabia", homeLogo: "ü¶Ö", awayLogo: "üá∏üá¶", score: "2 - 0", status: "FT", minute: "FT", events: [], stats: { possession: [35, 65], shots: [5, 12], xg: [1.2, 0.8] } },
            { id: 602, league: "UEFA EURO", date: "Final", home: "Spain", away: "England", homeLogo: "üá™üá∏", awayLogo: "üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†Åø", score: "2 - 1", status: "FT", minute: "FT", events: [], stats: { possession: [60, 40], shots: [15, 8], xg: [1.8, 0.9] } },
            { id: 603, league: "AFC Asian Cup", date: "Final", home: "Jordan", away: "Qatar", homeLogo: "üáØüá¥", awayLogo: "üá∂üá¶", score: "1 - 3", status: "FT", minute: "FT", events: [], stats: { possession: [45, 55], shots: [10, 12], xg: [1.1, 2.1] } },
            { id: 604, league: "Friendlies", date: "Today", home: "Thailand", away: "Vietnam", homeLogo: "üáπüá≠", awayLogo: "üáªüá≥", score: "-", status: "19:30", minute: "", events: [], stats: { possession: [50, 50], shots: [0, 0], xg: [0, 0] } }
        ];

        // --- RENDER LOGIC ---

        function init() {
            lucide.createIcons();
            renderMatches('All');
            
            document.getElementById('leagueSelect').addEventListener('change', (e) => {
                renderMatches(e.target.value);
            });
        }

        function renderMatches(filterLeague) {
            const container = document.getElementById('matchList');
            container.innerHTML = '';

            const matchesToRender = filterLeague === 'All' 
                ? mockMatches 
                : mockMatches.filter(m => m.league === filterLeague);

            if (matchesToRender.length === 0) {
                container.innerHTML = `
                    <div class="flex flex-col items-center justify-center h-64 text-[var(--text-muted)]">
                        <i data-lucide="calendar-off" class="w-12 h-12 mb-4 opacity-50"></i>
                        <p class="font-medium">No matches found.</p>
                    </div>
                `;
                lucide.createIcons();
                return;
            }

            // In "Live & Top Matches" (All) view, filter to show Today/Live only for cleanliness
            // But if user explicitly selects a league, show everything for that league
            let displayMatches = matchesToRender;
            if (filterLeague === 'All') {
                displayMatches = matchesToRender.filter(m => m.status === 'LIVE' || m.date === 'Today' || m.league === 'Premier League' || m.league === 'SPL (Singapore)');
            }

            // Sort by Status (Live first), then Date
            displayMatches.sort((a,b) => {
                if (a.status === 'LIVE' && b.status !== 'LIVE') return -1;
                if (a.status !== 'LIVE' && b.status === 'LIVE') return 1;
                return 0;
            });

            let currentLeagueHeader = '';
            displayMatches.forEach(match => {
                // Header
                if (filterLeague === 'All' && match.league !== currentLeagueHeader) {
                    currentLeagueHeader = match.league;
                    container.innerHTML += `
                        <div class="flex items-center space-x-2 pt-4 pb-2 sticky top-0 bg-[var(--bg-body)] z-0 transition-colors duration-300">
                            <div class="w-1 h-4 theme-accent rounded-full"></div>
                            <h2 class="text-xs font-bold text-[var(--text-muted)] uppercase tracking-widest font-display">${match.league}</h2>
                        </div>
                    `;
                }

                const isLive = match.status === 'LIVE';
                const statusStyle = isLive 
                    ? `color: var(--live-color); font-weight: bold;` 
                    : `color: var(--text-muted);`;

                const timeOrScore = isLive 
                    ? `<span class="flex items-center gap-1.5"><span class="w-1.5 h-1.5 rounded-full live-indicator"></span> ${match.minute}</span>` 
                    : match.status;

                const div = document.createElement('div');
                div.className = 'card-gradient rounded-xl p-4 shadow-md active:scale-[0.98] transition-all duration-100 cursor-pointer mb-3 relative overflow-hidden group';
                div.onclick = () => openModal(match.id);
                
                div.innerHTML = `
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3 w-[35%]">
                            <div class="text-lg">${match.homeLogo}</div>
                            <span class="text-sm font-semibold truncate text-[var(--text-main)]">${match.home}</span>
                        </div>
                        <div class="flex flex-col items-center w-[30%]">
                            <span class="text-2xl font-bold tracking-tight font-display tabular-nums text-[var(--text-main)]">${match.score}</span>
                            <span class="text-[10px] mt-1 uppercase tracking-wide" style="${statusStyle}">${timeOrScore}</span>
                        </div>
                        <div class="flex items-center justify-end space-x-3 w-[35%]">
                            <span class="text-sm font-semibold truncate text-[var(--text-main)] text-right">${match.away}</span>
                            <div class="text-lg">${match.awayLogo}</div>
                        </div>
                    </div>
                `;
                container.appendChild(div);
            });
            lucide.createIcons();
        }

        // --- MODAL LOGIC (Same as before) ---
        function openModal(matchId) {
            const match = mockMatches.find(m => m.id === matchId);
            if (!match) return;

            document.getElementById('modalLeague').textContent = match.league;
            document.getElementById('modalHomeName').textContent = match.home;
            document.getElementById('modalAwayName').textContent = match.away;
            document.getElementById('modalScore').textContent = match.score;
            document.getElementById('modalHomeLogo').textContent = match.homeLogo;
            document.getElementById('modalAwayLogo').textContent = match.awayLogo;

            const statusEl = document.getElementById('modalStatus');
            if (match.status === 'LIVE') {
                statusEl.innerHTML = `LIVE ${match.minute}`;
                statusEl.style.color = 'var(--live-color)';
                statusEl.style.borderColor = 'var(--live-color)';
            } else {
                statusEl.textContent = match.status === 'FT' ? "Full Time" : match.status;
                statusEl.style.color = 'var(--text-muted)';
                statusEl.style.borderColor = 'var(--border-color)';
            }

            const eventsContainer = document.getElementById('eventsList');
            eventsContainer.innerHTML = '';
            if(!match.events || match.events.length === 0) {
                 eventsContainer.innerHTML = `<div class="text-xs text-[var(--text-muted)] italic py-2">No key events recorded</div>`;
            } else {
                match.events.forEach(ev => {
                    const isHome = ev.team === 'home';
                    const div = document.createElement('div');
                    div.className = "relative flex items-center mb-6 last:mb-0";
                    div.innerHTML = `
                        <div class="absolute -left-[21px] w-2.5 h-2.5 rounded-full bg-[var(--border-color)] border-2 border-[var(--bg-card)]"></div>
                        <div class="text-xs font-mono font-bold text-[var(--text-muted)] w-8">${ev.time}</div>
                        <div class="flex-1 flex items-center ${isHome ? 'flex-row' : 'flex-row-reverse'} p-2 rounded border theme-border theme-bg-card shadow-sm">
                            <span class="text-lg mx-2">${ev.type === 'goal' ? '‚öΩ' : (ev.card==='yellow'?'üü®':'üü•')}</span>
                            <div class="flex flex-col ${isHome ? 'items-start' : 'items-end'}">
                                <span class="text-xs font-bold text-[var(--text-main)]">${ev.player}</span>
                                <span class="text-[10px] text-[var(--text-muted)] uppercase">${ev.type}</span>
                            </div>
                        </div>
                    `;
                    eventsContainer.appendChild(div);
                });
            }

            const statsContainer = document.getElementById('statsList');
            statsContainer.innerHTML = '';
            const statKeys = [{k: 'possession', l: 'Possession %'}, {k: 'xg', l: 'Expected Goals'}, {k: 'shots', l: 'Shots'}];
            statKeys.forEach(s => {
                const h = match.stats[s.k][0];
                const a = match.stats[s.k][1];
                const total = h + a || 1;
                const hPct = (h / total) * 100;
                
                statsContainer.innerHTML += `
                    <div class="mb-3">
                        <div class="flex justify-between text-xs font-mono text-[var(--text-muted)] mb-1">
                            <span>${h}</span>
                            <span class="font-sans font-bold uppercase tracking-wider text-[10px]">${s.l}</span>
                            <span>${a}</span>
                        </div>
                        <div class="h-1.5 bg-[var(--border-color)] rounded-full overflow-hidden flex">
                            <div class="h-full theme-accent" style="width: ${hPct}%"></div>
                            <div class="h-full bg-gray-500 opacity-30" style="width: ${100 - hPct}%"></div>
                        </div>
                    </div>
                `;
            });

            document.getElementById('matchModal').classList.remove('hidden');
            setTimeout(() => {
                document.getElementById('modalBackdrop').classList.remove('opacity-0');
                document.getElementById('modalPanel').classList.remove('modal-enter');
            }, 10);
        }

        function closeModal() {
            const modal = document.getElementById('matchModal');
            const backdrop = document.getElementById('modalBackdrop');
            const panel = document.getElementById('modalPanel');

            backdrop.classList.add('opacity-0');
            panel.classList.add('modal-exit-active');
            
            setTimeout(() => {
                modal.classList.add('hidden');
                panel.classList.remove('modal-exit-active');
            }, 300);
        }

        init();
    </script>
</body>
</html>
